{% extends "prototype2/layout.html" %}

{% block pageTitle %}
  GOV.UK Prototype Kit
{% endblock %}

{% set prisoner = data.prisoners | getPrisoner(id) %}

{% macro checked_attr(prisoner, pomType) %}
  {% if(prisoner.pom_type == pomType) %}
    {{"checked"}}
  {% endif %}
{% endmacro %}

{% macro conditional_override(prisoner, type) %}
  {% if(prisoner.pom_type != type) %}
    {{ 'data-aria-controls=conditional-allocate-conditional-1' -}}
  {% endif %}
{% endmacro %}

{% macro pom_type_recommendation(prisoner) %}
  {% if(prisoner.pom_type == "Prison-POM") %}
    {{"Prison officer POM"}}
  {% else %}
    {{"Probation officer POM"}}
  {% endif %}
{% endmacro %}

{% block content %}

  {{ govukBackLink({
    text: "Back",
    href: "javascript:window.history.back();"
  }) }}

  <h1 class="govuk-heading-l">Tiering calculation for {{prisoner | personName}} ({{prisoner.number}})</h1>

  <div class="govuk-panel govuk-panel--confirmation">
    <h1 class="govuk-panel__title">
      <span class="govuk-!-font-size-80">{{prisoner.tier}}</span>
      <br/>Tier calculation
    </h1>
    <div class="govuk-panel__body">
      {{prisoner | fullName}} should be allocated to a Prison officer POM
    </div>
  </div>

  <form action='/prototype2/confirm_tiering/{{prisoner.id}}' method="post">
  <div class="govuk-form-group">
    <fieldset class="govuk-fieldset">
      <legend class="govuk-fieldset__legend">
        <h1 class="govuk-fieldset__heading">
          Who would you like to allocate {{prisoner | fullName}} to?
        </h1>
      </legend>
      <div class="govuk-radios" data-module="radios">
        <div class="govuk-radios__item">
          <input {{checked_attr(prisoner, "Probation-POM")}} class="govuk-radios__input" id="allocate-conditional-1" name="allocate" type="radio" value="Probation-POM" {{ conditional_override(prisoner, "Probation-POM") }}>
          <label class="govuk-label govuk-radios__label" for="allocate-conditional-1">
            Probation officer POM
          </label>
        </div>
        <div class="govuk-radios__item">
          <input {{checked_attr(prisoner, "Prison-POM")}} class="govuk-radios__input" id="allocate-conditional-2" name="allocate" type="radio" value="Prison-POM" {{ conditional_override(prisoner, "Prison-POM") }}>
          <label class="govuk-label govuk-radios__label" for="allocate-conditional-2">
            Prison officer POM
          </label>
        </div>
        <div class="govuk-radios__conditional govuk-radios__conditional--hidden" id="conditional-allocate-conditional-1">
          {{ govukCheckboxes({
            idPrefix: "reasons",
            name: "reasons",
            fieldset: {
              legend: {
                text: "Choose reasons for changing the recommended grade"
              }
            },
            items: [
              {
                value: "complex",
                text: "Prisoner assessed as too complex for Prison officer POM"
              },
              {
                value: "unavailable",
                text: "No available staff at the recommended grade"
              },
              {
                value: "continuity",
                text: "Maintain continuity with previous POM"
              },
              {
                value: "other",
                text: "Other reason"
              }
            ]
          }) }}

        </div>
      </div>
    </fieldset>
  </div>

  {{ govukButton({ text: "Complete" }) }}
  </form>



{% endblock %}
